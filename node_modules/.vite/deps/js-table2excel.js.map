{
  "version": 3,
  "sources": ["../../js-table2excel/index.js"],
  "sourcesContent": ["/* eslint-disable */\r\nlet idTmr;\r\nconst getExplorer = () => {\r\n\tlet explorer = window.navigator.userAgent;\r\n\t//ie\r\n\tif (explorer.indexOf(\"MSIE\") >= 0) {\r\n\t\treturn 'ie';\r\n\t}\r\n\t//firefox\r\n\r\n\telse if (explorer.indexOf(\"Firefox\") >= 0) {\r\n\t\treturn 'Firefox';\r\n\t}\r\n\t//Chrome\r\n\telse if (explorer.indexOf(\"Chrome\") >= 0) {\r\n\t\treturn 'Chrome';\r\n\t}\r\n\t//Opera\r\n\telse if (explorer.indexOf(\"Opera\") >= 0) {\r\n\t\treturn 'Opera';\r\n\t}\r\n\t//Safari\r\n\telse if (explorer.indexOf(\"Safari\") >= 0) {\r\n\t\treturn 'Safari';\r\n\t}\r\n}\r\n// 判断浏览器是否为IE\r\nconst exportToExcel = (data, name) => {\r\n\r\n\t// 判断是否为IE\r\n\tif (getExplorer() == 'ie') {\r\n\t\ttableToIE(data, name)\r\n\t} else {\r\n\t\ttableToNotIE(data, name)\r\n\t}\r\n}\r\n\r\nconst Cleanup = () => {\r\n\twindow.clearInterval(idTmr);\r\n}\r\n\r\n// ie浏览器下执行\r\nconst tableToIE = (data, name) => {\r\n\tlet curTbl = data;\r\n\tlet oXL = new ActiveXObject(\"Excel.Application\");\r\n\r\n\t//创建AX对象excel\r\n\tlet oWB = oXL.Workbooks.Add();\r\n\t//获取workbook对象\r\n\tlet xlsheet = oWB.Worksheets(1);\r\n\t//激活当前sheet\r\n\tlet sel = document.body.createTextRange();\r\n\tsel.moveToElementText(curTbl);\r\n\t//把表格中的内容移到TextRange中\r\n\tsel.select;\r\n\t//全选TextRange中内容\r\n\tsel.execCommand(\"Copy\");\r\n\t//复制TextRange中内容\r\n\txlsheet.Paste();\r\n\t//粘贴到活动的EXCEL中\r\n\r\n\toXL.Visible = true;\r\n\t//设置excel可见属性\r\n\r\n\ttry {\r\n\t\tlet fname = oXL.Application.GetSaveAsFilename(\"Excel.xls\", \"Excel Spreadsheets (*.xls), *.xls\");\r\n\t} catch (e) {\r\n\t\tprint(\"Nested catch caught \" + e);\r\n\t} finally {\r\n\t\toWB.SaveAs(fname);\r\n\r\n\t\toWB.Close(savechanges = false);\r\n\t\t//xls.visible = false;\r\n\t\toXL.Quit();\r\n\t\toXL = null;\r\n\t\t// 结束excel进程，退出完成\r\n\t\twindow.setInterval(\"Cleanup();\", 1);\r\n\t\tidTmr = window.setInterval(\"Cleanup();\", 1);\r\n\t}\r\n}\r\n\r\n// 非ie浏览器下执行\r\nconst tableToNotIE = (function () {\r\n\t// 编码要用utf-8不然默认gbk会出现中文乱码\r\n\tconst uri = 'data:application/vnd.ms-excel;base64,',\r\n\t\ttemplate = '<html xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:x=\"urn:schemas-microsoft-com:office:excel\" xmlns=\"http://www.w3.org/TR/REC-html40\"><head><meta charset=\"UTF-8\"><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>';\r\n\r\n\tconst base64 = function (s) {\r\n\t\treturn window.btoa(unescape(encodeURIComponent(s)));\r\n\t}\r\n\r\n\tconst format = (s, c) => {\r\n\t\treturn s.replace(/{(\\w+)}/g,\r\n\t\t\t(m, p) => {\r\n\t\t\t\treturn c[p];\r\n\t\t\t})\r\n\t}\r\n\r\n\treturn (table, name) => {\r\n\t\tconst ctx = {\r\n\t\t\tworksheet: name,\r\n\t\t\ttable\r\n\t\t}\r\n\r\n\t\tconst url = uri + base64(format(template, ctx));\r\n\r\n\t\tif (navigator.userAgent.indexOf(\"Firefox\") > -1){\r\n\t\t\twindow.location.href = url\r\n\t\t} else {\r\n\t\t\tconst aLink = document.createElement('a');\r\n\t\t\taLink.href = url;\r\n\t\t\taLink.download = name || '';\r\n\t\t\tlet event;\r\n\t\t\tif (window.MouseEvent) {\r\n\t\t\t\tevent = new MouseEvent('click');\r\n\t\t\t} else {\r\n\t\t\t\tevent = document.createEvent('MouseEvents');\r\n\t\t\t\tevent.initMouseEvent('click', true, false, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);\r\n\t\t\t}\r\n\t\t\taLink.dispatchEvent(event);\r\n\t\t}\r\n\t}\r\n})()\r\n\r\n// 导出函数\r\nconst table2excel = (column, data, excelName) => {\r\n\tconst typeMap = {\r\n\t\timage: getImageHtml,\r\n\t\ttext: getTextHtml\r\n\t}\r\n\r\n\tlet thead = column.reduce((result, item) => {\r\n\t\tresult += `<th>${item.title}</th>`\r\n\t\treturn result\r\n\t}, '')\r\n\r\n\tthead = `<thead><tr>${thead}</tr></thead>`\r\n\r\n\tlet tbody = data.reduce((result, row) => {\r\n\t\tconst temp = column.reduce((tds, col) => {\r\n\t\t\ttds += typeMap[col.type || 'text'](row[col.key], col)\r\n\t\t\treturn tds\r\n\t\t}, '')\r\n\t\tresult += `<tr>${temp}</tr>`\r\n\t\treturn result\r\n\t}, '')\r\n\r\n\ttbody = `<tbody>${tbody}</tbody>`\r\n\r\n\tconst table = thead + tbody\r\n\r\n\t// 导出表格\r\n\texportToExcel(table, excelName)\r\n\r\n\tfunction getTextHtml(val) {\r\n\t\treturn `<td style=\"text-align: center\">${val}</td>`\r\n\t}\r\n\r\n\tfunction getImageHtml(val, options) {\r\n\t\toptions = Object.assign({width: 40, height: 60}, options)\r\n\t\treturn `<td style=\"width: ${options.width}px; height: ${options.height}px; text-align: center; vertical-align: middle\"><img src=\"${val}\" width=${options.width} height=${options.height}></td>`\r\n\t}\r\n}\r\n\r\nexport default table2excel\r\n"],
  "mappings": "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",
  "names": ["fname"]
}
